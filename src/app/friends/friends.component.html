<div class="friends-container">
  <div class="friends-header">
    <h2>Friends Management</h2>
    <p class="subtitle">Manage your friends and test WebSocket notifications</p>
  </div>

  <div class="error-message" *ngIf="error" (click)="clearError()">
    {{ error }}
    <span class="close-btn">Ã—</span>
  </div>

  <div class="friends-section">
    <h3>Send Friend Request</h3>
    <div class="send-request-form">
      <div class="form-group">
        <label for="username">Username</label>
        <input 
          id="username"
          type="text" 
          [(ngModel)]="newFriendUsername" 
          placeholder="Enter username"
          [disabled]="isLoading">
      </div>
      <div class="form-group">
        <label for="message">Message (optional)</label>
        <textarea 
          id="message"
          [(ngModel)]="requestMessage" 
          placeholder="Add a personal message..."
          rows="3"
          [disabled]="isLoading"></textarea>
      </div>
      <button 
        class="btn-primary" 
        (click)="sendFriendRequest()" 
        [disabled]="isLoading || !newFriendUsername.trim()">
        {{ isLoading ? 'Sending...' : 'Send Request' }}
      </button>
    </div>
  </div>

  <div class="friends-section">
    <h3>Received Friend Requests ({{ friendRequests.length }})</h3>
    <div class="requests-list" *ngIf="friendRequests.length > 0; else noRequests">
      <div class="request-item" *ngFor="let request of friendRequests">
        <div class="request-info">
          <strong>{{ request.senderUsername }}</strong>
          <p class="request-message" *ngIf="request.message">{{ request.message }}</p>
          <span class="request-date">{{ request.createdAt | date:'short' }}</span>
        </div>
        <div class="request-actions">
          <button class="btn-secondary" (click)="respondToRequest(request.senderUsername, false)">
            Decline
          </button>
          <button class="btn-primary" (click)="respondToRequest(request.senderUsername, true)">
            Accept
          </button>
        </div>
      </div>
    </div>
    <ng-template #noRequests>
      <p class="empty-state">No pending friend requests</p>
    </ng-template>
  </div>

  <div class="friends-section">
    <h3>Sent Requests ({{ sentRequests.length }})</h3>
    <div class="requests-list" *ngIf="sentRequests.length > 0; else noSentRequests">
      <div class="request-item" *ngFor="let request of sentRequests">
        <div class="request-info">
          <strong>{{ request.targetUsername }}</strong>
          <p class="request-message" *ngIf="request.message">{{ request.message }}</p>
          <span class="request-date">{{ request.createdAt | date:'short' }}</span>
          <span class="status-badge pending">Pending</span>
        </div>
      </div>
    </div>
    <ng-template #noSentRequests>
      <p class="empty-state">No sent requests</p>
    </ng-template>
  </div>

  <div class="friends-section">
    <h3>Friends ({{ friends.length }})</h3>
    <div class="friends-list" *ngIf="friends.length > 0; else noFriends">
      <div class="friend-item" *ngFor="let friend of friends">
        <div class="friend-info">
          <strong>{{ friend.username }}</strong>
          <span class="friend-since">Friends since {{ friend.createdAt | date:'short' }}</span>
        </div>
        <div class="friend-actions">
          <button class="btn-danger" (click)="removeFriend(friend.username)">
            Remove
          </button>
        </div>
      </div>
    </div>
    <ng-template #noFriends>
      <p class="empty-state">No friends yet</p>
    </ng-template>
  </div>
</div>
